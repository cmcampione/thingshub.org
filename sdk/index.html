<!DOCTYPE html>

<html lang="it">
<head>
    <meta charset="utf-8" />

    <title>thinghub.org</title>

    <style>
    </style>

    <script src="node_modules/axios/dist/axios.min.js"></script>
    <script src="node_modules/socket.io-client/dist/socket.io.slim.js"></script>
    
    <script src="dist/thingshub-client-js.js"></script>

    <script>
      function authHook() {
        return "token=5e4ff11c-5391-465b-a9c4-9803e0b78799";
      }

      function onError(error) {
        console.log(error);
      }
      function onConnectError(error) {
        console.log(error);
      }

      function onStateChanged(change) {
        console.log(change);
      }

      function onAPI(data) {
        console.log(data);
      }

      function onCreateThing(thingDTO) {
        console.log(thingDTO);
      }

      function onUpdateThing(thingDTO) {
        console.log(thingDTO);
      }

      var endPointAddress = {
          server: "https://localhost:3000",
          api: "https://localhost:3000/api"    
      }

      function securityHeaderHook() {
        return { thapikey: "5e4ff11c-5391-465b-a9c4-9803e0b78799" };
      }

      var thingsDatacontext = new ThingsHubClient.ThingsDataContext(endPointAddress, securityHeaderHook);

      var thingsGetParams =  {
        parentThingId : null,
        thingFilter : "",
        valueFilter : "",
        orderBy : "",
        skip : 0,
        top : 100
      }

      thingsDatacontext.getThings(thingsGetParams)
      .then(function(res) {
        console.log(res);
      });


      var socket = new ThingsHubClient.SocketIOConnector("https://localhost:3000", authHook, onError, onConnectError, onStateChanged);
      socket.subscribe();
      socket.setHook("api", onAPI);
      socket.setHook("onCreateThing", onCreateThing);
      socket.setHook("onUpdateThing", onUpdateThing);
      
      socket.api()
      .then(function(res) {
        console.log(res);
      })
      .catch(function(err) {
        console.log(err);
      });

    </script>
    
</head>
<body>

	<div>
	</div>

</body>
</html>
